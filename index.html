
<!DOCTYPE html>
<html lang="zh-TW">
<head><meta property="og:title" content="Restaurant Manager 餐廳管理系統 -  Kuse AI"><meta property="og:description" content="Restaurant Manager 餐廳管理系統"><meta property="og:url" content="https://www.kuse.ai/pages/Restaurant-Manager-%E9%A4%90%E5%BB%B3%E7%AE%A1%E7%90%86%E7%B3%BB%E7%B5%B1/XjuTmanRatATcTxVMegS89"><meta property="og:type" content="article"><meta property="og:site_name" content="Kuse AI"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Restaurant Manager 餐廳管理系統 -  Kuse AI"><meta name="twitter:description" content="Restaurant Manager 餐廳管理系統"><meta name="twitter:site" content="@kuseHQ"><link rel="canonical" href="https://www.kuse.ai/pages/Restaurant-Manager-%E9%A4%90%E5%BB%B3%E7%AE%A1%E7%90%86%E7%B3%BB%E7%B5%B1/XjuTmanRatATcTxVMegS89"><meta name="description" content="Restaurant Manager 餐廳管理系統">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Manager 餐廳管理系統 -  Kuse AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --coral: #FF6B6B;
            --orange: #FFA07A;
            --cream: #FFF8F0;
            --gold: #FFD700;
            --dark: #2C3E50;
            --light: #FFFFFF;
            --gray: #95A5A6;
            --green: #2ECC71;
            --red: #E74C3C;
            --shadow: rgba(0, 0, 0, 0.1);
            --text: #2C3E50;
            --bg: #FFF8F0;
        }

        [data-theme="dark"] {
            --cream: #1A1A2E;
            --light: #16213E;
            --text: #EAEAEA;
            --bg: #0F0F1E;
            --shadow: rgba(255, 255, 255, 0.05);
            --gray: #7F8C8D;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--coral), var(--orange));
            padding: 30px 20px;
            text-align: center;
            box-shadow: 0 4px 20px var(--shadow);
            margin-bottom: 30px;
            border-radius: 0 0 20px 20px;
        }

        header h1 {
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.1rem;
        }

        .header-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .theme-toggle, .export-btn, .import-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .theme-toggle:hover, .export-btn:hover, .import-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 25px var(--shadow);
        }

        .stat-card i {
            font-size: 2rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--coral), var(--orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--coral);
            font-family: 'Poppins', sans-serif;
        }

        .stat-card .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--light);
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 4px 15px var(--shadow);
        }

        .tab {
            flex: 1;
            padding: 15px 30px;
            background: transparent;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--gray);
            font-family: 'Poppins', sans-serif;
        }

        .tab.active {
            background: linear-gradient(135deg, var(--coral), var(--orange));
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .tab:hover:not(.active) {
            background: rgba(255, 107, 107, 0.1);
            color: var(--coral);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-section {
            background: var(--light);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 4px 20px var(--shadow);
            margin-bottom: 30px;
        }

        .form-section h2 {
            color: var(--coral);
            margin-bottom: 25px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
            font-size: 0.95rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px 15px;
            border: 2px solid rgba(255, 107, 107, 0.2);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
            background: var(--cream);
            color: var(--text);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--coral);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 1.8rem;
        }

        .star-rating i {
            cursor: pointer;
            color: #DDD;
            transition: all 0.2s ease;
        }

        .star-rating i.active,
        .star-rating i:hover {
            color: var(--gold);
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--coral), var(--orange));
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            font-family: 'Poppins', sans-serif;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto 0;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 107, 107, 0.4);
        }

        .controls-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid rgba(255, 107, 107, 0.2);
            border-radius: 25px;
            font-size: 1rem;
            background: var(--light);
            color: var(--text);
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--coral);
        }

        .filter-select {
            padding: 12px 20px;
            border: 2px solid rgba(255, 107, 107, 0.2);
            border-radius: 25px;
            font-size: 1rem;
            background: var(--light);
            color: var(--text);
            cursor: pointer;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .restaurant-card {
            background: var(--light);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 4px 20px var(--shadow);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .restaurant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px var(--shadow);
            border-color: var(--coral);
        }

        .card-header {
            margin-bottom: 15px;
        }

        .card-header h3 {
            color: var(--coral);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .card-badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .badge-cuisine {
            background: linear-gradient(135deg, var(--coral), var(--orange));
            color: white;
        }

        .badge-price {
            background: rgba(46, 204, 113, 0.2);
            color: var(--green);
        }

        .badge-priority {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge-priority.high {
            background: rgba(231, 76, 60, 0.2);
            color: var(--red);
        }

        .badge-priority.medium {
            background: rgba(255, 160, 122, 0.3);
            color: var(--orange);
        }

        .badge-priority.low {
            background: rgba(46, 204, 113, 0.2);
            color: var(--green);
        }

        .card-info {
            margin-bottom: 15px;
        }

        .card-info p {
            margin: 8px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text);
        }

        .card-info i {
            color: var(--coral);
            width: 20px;
        }

        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--coral), var(--orange));
            color: white;
        }

        .btn-secondary {
            background: rgba(149, 165, 166, 0.2);
            color: var(--gray);
        }

        .btn-danger {
            background: rgba(231, 76, 60, 0.2);
            color: var(--red);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px var(--shadow);
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }

        .rating-stars {
            color: var(--gold);
            font-size: 1.2rem;
        }

        .rating-value {
            font-weight: 600;
            color: var(--text);
        }

        .rating-breakdown {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background: var(--cream);
            border-radius: 10px;
        }

        .rating-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .rating-item-stars {
            color: var(--gold);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--light);
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(231, 76, 60, 0.2);
            color: var(--red);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--red);
            color: white;
            transform: rotate(90deg);
        }

        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--green), #27AE60);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(46, 204, 113, 0.3);
            z-index: 2000;
            display: none;
            align-items: center;
            gap: 10px;
            animation: slideInRight 0.3s ease;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .success-message.show {
            display: flex;
        }

        footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 50px;
            border-top: 2px solid rgba(255, 107, 107, 0.1);
        }

        .kuse-branding {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--gray);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .kuse-branding:hover {
            color: var(--coral);
            transform: translateY(-2px);
        }

        .kuse-branding svg {
            height: 1.2em;
            transition: all 0.3s ease;
        }

        .kuse-branding:hover svg {
            color: var(--coral);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .controls-bar {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }

            .rating-breakdown {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 25px;
            }
        }

        @media print {
            .tabs, .form-section, .controls-bar, .card-actions, header .header-controls {
                display: none !important;
            }

            .restaurant-card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }

        input[type="file"] {
            display: none;
        }

        .return-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            display: inline-block;
            margin-top: 10px;
        }

        .return-badge.definitely {
            background: rgba(46, 204, 113, 0.2);
            color: var(--green);
        }

        .return-badge.maybe {
            background: rgba(255, 160, 122, 0.3);
            color: var(--orange);
        }

        .return-badge.probably-not {
            background: rgba(231, 76, 60, 0.2);
            color: var(--red);
        }

        .return-badge.never {
            background: rgba(44, 62, 80, 0.2);
            color: var(--dark);
        }
    </style>
<script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Restaurant Manager 餐廳管理系統 -  Kuse AI","description":"Restaurant Manager 餐廳管理系統","url":"https://www.kuse.ai/pages/Restaurant-Manager-%E9%A4%90%E5%BB%B3%E7%AE%A1%E7%90%86%E7%B3%BB%E7%B5%B1/XjuTmanRatATcTxVMegS89","author":{"@type":"Organization","name":"Kuse AI"},"publisher":{"@type":"Organization","name":"Kuse AI","url":"https://www.kuse.ai"},"inLanguage":"en","alternateName":"Restaurant Manager 餐廳管理系統"}</script></head>
<body>
    <header>
        <h1><i class="fas fa-utensils"></i> Restaurant Manager</h1>
        <p>追蹤您的美食之旅 | Track Your Culinary Journey</p>
        <div class="header-controls">
            <button class="theme-toggle" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
                <span>深色模式</span>
            </button>
            <button class="export-btn" onclick="exportData()">
                <i class="fas fa-download"></i>
                <span>匯出資料</span>
            </button>
            <label for="import-file" class="import-btn">
                <i class="fas fa-upload"></i>
                <span>匯入資料</span>
            </label>
            <input type="file" id="import-file" accept=".json" onchange="importData(event)">
        </div>
    </header>

    <div class="container">
        <div class="stats-bar">
            <div class="stat-card">
                <i class="fas fa-bookmark"></i>
                <div class="stat-value" id="stat-to-try">0</div>
                <div class="stat-label">想嘗試的餐廳</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-star"></i>
                <div class="stat-value" id="stat-rated">0</div>
                <div class="stat-label">已評分餐廳</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-chart-line"></i>
                <div class="stat-value" id="stat-avg-rating">0.0</div>
                <div class="stat-label">平均評分</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-fire"></i>
                <div class="stat-value" id="stat-top-cuisine">-</div>
                <div class="stat-label">最愛料理類型</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('to-try')">
                <i class="fas fa-bookmark"></i> 想嘗試的餐廳
            </button>
            <button class="tab" onclick="switchTab('rating')">
                <i class="fas fa-star"></i> 餐廳評分
            </button>
        </div>

        <div id="to-try-tab" class="tab-content active">
            <div class="form-section">
                <h2><i class="fas fa-plus-circle"></i> 新增想嘗試的餐廳</h2>
                <form id="to-try-form" onsubmit="addToTryRestaurant(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>餐廳名稱 *</label>
                            <input type="text" name="name" required placeholder="輸入餐廳名稱">
                        </div>
                        <div class="form-group">
                            <label>料理類型</label>
                            <select name="cuisine">
                                <option value="Italian">義式料理 (Italian)</option>
                                <option value="Japanese">日式料理 (Japanese)</option>
                                <option value="Chinese">中式料理 (Chinese)</option>
                                <option value="French">法式料理 (French)</option>
                                <option value="Thai">泰式料理 (Thai)</option>
                                <option value="Korean">韓式料理 (Korean)</option>
                                <option value="American">美式料理 (American)</option>
                                <option value="Mexican">墨西哥料理 (Mexican)</option>
                                <option value="Indian">印度料理 (Indian)</option>
                                <option value="Other">其他 (Other)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>地點/地址</label>
                            <input type="text" name="location" placeholder="輸入餐廳地址">
                        </div>
                        <div class="form-group">
                            <label>價格範圍</label>
                            <select name="price">
                                <option value="$">$ - 經濟實惠</option>
                                <option value="$$">$$ - 中等價位</option>
                                <option value="$$$">$$$ - 較高價位</option>
                                <option value="$$$$">$$$$ - 高級餐廳</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>推薦人</label>
                            <input type="text" name="recommended-by" placeholder="誰推薦了這家餐廳？">
                        </div>
                        <div class="form-group">
                            <label>優先級</label>
                            <select name="priority">
                                <option value="high">高 (High)</option>
                                <option value="medium">中 (Medium)</option>
                                <option value="low">低 (Low)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>想嘗試的原因</label>
                        <textarea name="reason" placeholder="為什麼想嘗試這家餐廳？"></textarea>
                    </div>
                    <div class="form-group">
                        <label>備註</label>
                        <textarea name="notes" placeholder="其他備註資訊"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-plus"></i>
                        <span>新增餐廳</span>
                    </button>
                </form>
            </div>

            <div class="controls-bar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-to-try" placeholder="搜尋餐廳..." oninput="filterToTry()">
                </div>
                <select class="filter-select" id="filter-cuisine-to-try" onchange="filterToTry()">
                    <option value="">所有料理類型</option>
                    <option value="Italian">義式料理</option>
                    <option value="Japanese">日式料理</option>
                    <option value="Chinese">中式料理</option>
                    <option value="French">法式料理</option>
                    <option value="Thai">泰式料理</option>
                    <option value="Korean">韓式料理</option>
                    <option value="American">美式料理</option>
                    <option value="Mexican">墨西哥料理</option>
                    <option value="Indian">印度料理</option>
                    <option value="Other">其他</option>
                </select>
                <select class="filter-select" id="sort-to-try" onchange="filterToTry()">
                    <option value="date-desc">最新加入</option>
                    <option value="date-asc">最早加入</option>
                    <option value="name-asc">名稱 A-Z</option>
                    <option value="name-desc">名稱 Z-A</option>
                    <option value="priority-high">優先級：高到低</option>
                    <option value="priority-low">優先級：低到高</option>
                </select>
            </div>

            <div id="to-try-list" class="cards-grid"></div>
        </div>

        <div id="rating-tab" class="tab-content">
            <div class="form-section">
                <h2><i class="fas fa-star"></i> 新增餐廳評分</h2>
                <form id="rating-form" onsubmit="addRating(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>餐廳名稱 *</label>
                            <input type="text" name="name" required placeholder="輸入餐廳名稱">
                        </div>
                        <div class="form-group">
                            <label>料理類型</label>
                            <select name="cuisine">
                                <option value="Italian">義式料理 (Italian)</option>
                                <option value="Japanese">日式料理 (Japanese)</option>
                                <option value="Chinese">中式料理 (Chinese)</option>
                                <option value="French">法式料理 (French)</option>
                                <option value="Thai">泰式料理 (Thai)</option>
                                <option value="Korean">韓式料理 (Korean)</option>
                                <option value="American">美式料理 (American)</option>
                                <option value="Mexican">墨西哥料理 (Mexican)</option>
                                <option value="Indian">印度料理 (Indian)</option>
                                <option value="Other">其他 (Other)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>地點/地址</label>
                            <input type="text" name="location" placeholder="輸入餐廳地址">
                        </div>
                        <div class="form-group">
                            <label>造訪日期</label>
                            <input type="date" name="visit-date">
                        </div>
                        <div class="form-group">
                            <label>實付金額</label>
                            <input type="number" name="price-paid" placeholder="0" min="0">
                        </div>
                        <div class="form-group">
                            <label>是否會再次光臨？</label>
                            <select name="would-return">
                                <option value="definitely">絕對會 (Definitely)</option>
                                <option value="maybe">可能會 (Maybe)</option>
                                <option value="probably-not">可能不會 (Probably Not)</option>
                                <option value="never">絕不會 (Never)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>整體評分</label>
                            <div class="star-rating" data-rating="overall">
                                <i class="far fa-star" data-value="1"></i>
                                <i class="far fa-star" data-value="2"></i>
                                <i class="far fa-star" data-value="3"></i>
                                <i class="far fa-star" data-value="4"></i>
                                <i class="far fa-star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="overall-rating" value="0">
                        </div>
                        <div class="form-group">
                            <label>食物品質</label>
                            <div class="star-rating" data-rating="food">
                                <i class="far fa-star" data-value="1"></i>
                                <i class="far fa-star" data-value="2"></i>
                                <i class="far fa-star" data-value="3"></i>
                                <i class="far fa-star" data-value="4"></i>
                                <i class="far fa-star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="food-rating" value="0">
                        </div>
                        <div class="form-group">
                            <label>服務品質</label>
                            <div class="star-rating" data-rating="service">
                                <i class="far fa-star" data-value="1"></i>
                                <i class="far fa-star" data-value="2"></i>
                                <i class="far fa-star" data-value="3"></i>
                                <i class="far fa-star" data-value="4"></i>
                                <i class="far fa-star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="service-rating" value="0">
                        </div>
                        <div class="form-group">
                            <label>環境氛圍</label>
                            <div class="star-rating" data-rating="ambiance">
                                <i class="far fa-star" data-value="1"></i>
                                <i class="far fa-star" data-value="2"></i>
                                <i class="far fa-star" data-value="3"></i>
                                <i class="far fa-star" data-value="4"></i>
                                <i class="far fa-star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="ambiance-rating" value="0">
                        </div>
                        <div class="form-group">
                            <label>性價比</label>
                            <div class="star-rating" data-rating="value">
                                <i class="far fa-star" data-value="1"></i>
                                <i class="far fa-star" data-value="2"></i>
                                <i class="far fa-star" data-value="3"></i>
                                <i class="far fa-star" data-value="4"></i>
                                <i class="far fa-star" data-value="5"></i>
                            </div>
                            <input type="hidden" name="value-rating" value="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>點餐內容</label>
                        <textarea name="dishes" placeholder="列出您點的餐點"></textarea>
                    </div>
                    <div class="form-group">
                        <label>亮點特色</label>
                        <textarea name="highlights" placeholder="您最喜歡的部分"></textarea>
                    </div>
                    <div class="form-group">
                        <label>改進建議</label>
                        <textarea name="improvements" placeholder="有什麼可以做得更好？"></textarea>
                    </div>
                    <div class="form-group">
                        <label>整體評價</label>
                        <textarea name="review" placeholder="詳細的用餐體驗評價"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-star"></i>
                        <span>新增評分</span>
                    </button>
                </form>
            </div>

            <div class="controls-bar">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-rating" placeholder="搜尋餐廳..." oninput="filterRatings()">
                </div>
                <select class="filter-select" id="filter-cuisine-rating" onchange="filterRatings()">
                    <option value="">所有料理類型</option>
                    <option value="Italian">義式料理</option>
                    <option value="Japanese">日式料理</option>
                    <option value="Chinese">中式料理</option>
                    <option value="French">法式料理</option>
                    <option value="Thai">泰式料理</option>
                    <option value="Korean">韓式料理</option>
                    <option value="American">美式料理</option>
                    <option value="Mexican">墨西哥料理</option>
                    <option value="Indian">印度料理</option>
                    <option value="Other">其他</option>
                </select>
                <select class="filter-select" id="sort-rating" onchange="filterRatings()">
                    <option value="date-desc">最新造訪</option>
                    <option value="date-asc">最早造訪</option>
                    <option value="rating-high">評分：高到低</option>
                    <option value="rating-low">評分：低到高</option>
                    <option value="name-asc">名稱 A-Z</option>
                    <option value="name-desc">名稱 Z-A</option>
                </select>
            </div>

            <div id="rating-list" class="cards-grid"></div>
        </div>
    </div>

    <div id="review-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
            <div id="modal-body"></div>
        </div>
    </div>

    <div id="success-message" class="success-message">
        <i class="fas fa-check-circle"></i>
        <span id="success-text"></span>
    </div>

    <footer>
        <a href="https://kuse.ai" target="_blank" class="kuse-branding">
            <span>made with</span>
            <svg viewBox="0,0,160,44" xmlns="http://www.w3.org/2000/svg"><path d="m.01,20.65C-.43,8.25,9.3-2.03,22.04.34,34.78,2.72,43.29,8.32,43.29,22.9s-8.66,19.01-22.03,20.3C7.9,44.5.46,33.05.01,20.65z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="m146.76,7.94c8.07,0,13.24,6.15,13.24,14.58v1.39h-20.75c.45,4.05,3.51,7.37,8.57,7.37,2.62,0,5.73-1.05,7.62-2.94l2.67,3.83c-2.67,2.55-6.62,3.88-10.9,3.88-8.07,0-14.08-5.6-14.08-14.08,0-7.76,5.67-14.02,13.63-14.02zm0,4.77c-5.01,0-7.29,3.83-7.57,7.1h15.13c-.11-3.16-2.28-7.1-7.57-7.1z" fill="currentColor"/><path d="m86.64,24.49c0,4.15,2.39,6.84,6.84,6.84,4.4,0,6.84-2.69,6.84-6.84V8.55h5.37v16.33c0,6.7-4.06,11.14-12.21,11.14-8.21,0-12.21-4.5-12.21-11.09V8.55h5.37v15.94zm32.99-16.55c4.49,0,8.06,1.47,10.6,3.86l-2.59,3.81c-2.05-2-5.28-3.08-8.06-3.08-2.88,0-4.84,1.37-4.84,3.32,0,1.91,2.64,2.54,5.81,3.27,4.59,1.08,10.26,2.4,10.26,8.46,0,4.94-3.76,8.41-11.14,8.41-4.98,0-8.94-1.76-11.24-4.11l2.54-4.11c1.86,1.91,5.18,3.67,8.84,3.67,3.91,0,5.57-1.66,5.57-3.62,0-2.3-2.88-2.98-6.21-3.76-4.54-1.08-9.87-2.3-9.87-8.06,0-4.5,4.2-8.06,10.31-8.06zM60.79,20.82,71.44,8.55h6.5L66.46,21.26,78.82,35.44h-6.5l-9.28-11.1-2.25,2.49v8.6h-5.33V8.55h5.33v12.27z" fill="currentColor"/></svg>
        </a>
    </footer>

    <script>
        let toTryRestaurants = JSON.parse(localStorage.getItem(`toTryRestaurants`)) || [];
        let ratedRestaurants = JSON.parse(localStorage.getItem(`ratedRestaurants`)) || [];
        let editingToTryId = null;
        let editingRatingId = null;

        function syncToFirebase() {
            localStorage.setItem(`toTryRestaurants`, JSON.stringify(toTryRestaurants));
            localStorage.setItem(`ratedRestaurants`, JSON.stringify(ratedRestaurants));
        }

        function loadFromFirebase() {
            renderToTryList();
            renderRatingList();
            updateStats();
        }

        function initializeStarRatings() {
            document.querySelectorAll(`.star-rating`).forEach(container => {
                const stars = container.querySelectorAll(`i`);
                const ratingType = container.dataset.rating;
                const input = container.parentElement.querySelector(`input[type="hidden"]`);

                stars.forEach((star, index) => {
                    star.addEventListener(`click`, () => {
                        const value = parseInt(star.dataset.value);
                        input.value = value;
                        updateStars(stars, value);
                    });

                    star.addEventListener(`mouseenter`, () => {
                        const value = parseInt(star.dataset.value);
                        updateStars(stars, value);
                    });
                });

                container.addEventListener(`mouseleave`, () => {
                    const currentValue = parseInt(input.value);
                    updateStars(stars, currentValue);
                });
            });
        }

        function updateStars(stars, value) {
            stars.forEach((star, index) => {
                if (index < value) {
                    star.classList.remove(`far`);
                    star.classList.add(`fas`, `active`);
                } else {
                    star.classList.remove(`fas`, `active`);
                    star.classList.add(`far`);
                }
            });
        }

        function addToTryRestaurant(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);

            const restaurant = {
                id: editingToTryId || Date.now(),
                name: formData.get(`name`),
                cuisine: formData.get(`cuisine`),
                location: formData.get(`location`),
                price: formData.get(`price`),
                recommendedBy: formData.get(`recommended-by`),
                reason: formData.get(`reason`),
                priority: formData.get(`priority`),
                notes: formData.get(`notes`),
                dateAdded: editingToTryId ? toTryRestaurants.find(r => r.id === editingToTryId).dateAdded : new Date().toISOString()
            };

            if (editingToTryId) {
                const index = toTryRestaurants.findIndex(r => r.id === editingToTryId);
                toTryRestaurants[index] = restaurant;
                showSuccess(`餐廳資訊已更新！`);
                editingToTryId = null;
            } else {
                toTryRestaurants.push(restaurant);
                showSuccess(`已新增餐廳到清單！`);
            }

            syncToFirebase();
            form.reset();
            renderToTryList();
            updateStats();
        }

        function renderToTryList() {
            const container = document.getElementById(`to-try-list`);
            const searchTerm = document.getElementById(`search-to-try`).value.toLowerCase();
            const cuisineFilter = document.getElementById(`filter-cuisine-to-try`).value;
            const sortOption = document.getElementById(`sort-to-try`).value;

            let filtered = toTryRestaurants.filter(r => {
                const matchesSearch = r.name.toLowerCase().includes(searchTerm) || 
                                     (r.location && r.location.toLowerCase().includes(searchTerm));
                const matchesCuisine = !cuisineFilter || r.cuisine === cuisineFilter;
                return matchesSearch && matchesCuisine;
            });

            filtered.sort((a, b) => {
                switch(sortOption) {
                    case `date-desc`: return new Date(b.dateAdded) - new Date(a.dateAdded);
                    case `date-asc`: return new Date(a.dateAdded) - new Date(b.dateAdded);
                    case `name-asc`: return a.name.localeCompare(b.name);
                    case `name-desc`: return b.name.localeCompare(a.name);
                    case `priority-high`: 
                        const priorityOrder = {high: 3, medium: 2, low: 1};
                        return priorityOrder[b.priority] - priorityOrder[a.priority];
                    case `priority-low`:
                        const priorityOrder2 = {high: 3, medium: 2, low: 1};
                        return priorityOrder2[a.priority] - priorityOrder2[b.priority];
                    default: return 0;
                }
            });

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-utensils"></i>
                        <h3>還沒有想嘗試的餐廳</h3>
                        <p>開始新增您想嘗試的餐廳吧！</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(r => `
                <div class="restaurant-card">
                    <div class="card-header">
                        <h3>${r.name}</h3>
                    </div>
                    <div class="card-badges">
                        <span class="badge badge-cuisine">
                            <i class="fas fa-utensils"></i> ${r.cuisine}
                        </span>
                        <span class="badge badge-price">
                            <i class="fas fa-dollar-sign"></i> ${r.price}
                        </span>
                        <span class="badge-priority ${r.priority}">
                            <i class="fas fa-flag"></i> ${r.priority === `high` ? `高優先` : r.priority === `medium` ? `中優先` : `低優先`}
                        </span>
                    </div>
                    <div class="card-info">
                        ${r.location ? `<p><i class="fas fa-map-marker-alt"></i> ${r.location}</p>` : ``}
                        ${r.recommendedBy ? `<p><i class="fas fa-user"></i> 推薦人：${r.recommendedBy}</p>` : ``}
                        ${r.reason ? `<p><i class="fas fa-lightbulb"></i> ${r.reason.substring(0, 100)}${r.reason.length > 100 ? `...` : ``}</p>` : ``}
                        ${r.notes ? `<p><i class="fas fa-sticky-note"></i> ${r.notes.substring(0, 80)}${r.notes.length > 80 ? `...` : ``}</p>` : ``}
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-primary" onclick="markAsVisited(${r.id})">
                            <i class="fas fa-check"></i> 標記為已造訪
                        </button>
                        <button class="btn btn-secondary" onclick="editToTry(${r.id})">
                            <i class="fas fa-edit"></i> 編輯
                        </button>
                        <button class="btn btn-danger" onclick="deleteToTry(${r.id})">
                            <i class="fas fa-trash"></i> 刪除
                        </button>
                    </div>
                </div>
            `).join(``);
        }

        function editToTry(id) {
            const restaurant = toTryRestaurants.find(r => r.id === id);
            if (!restaurant) return;

            editingToTryId = id;
            const form = document.getElementById(`to-try-form`);
            form.elements[`name`].value = restaurant.name;
            form.elements[`cuisine`].value = restaurant.cuisine;
            form.elements[`location`].value = restaurant.location || ``;
            form.elements[`price`].value = restaurant.price;
            form.elements[`recommended-by`].value = restaurant.recommendedBy || ``;
            form.elements[`reason`].value = restaurant.reason || ``;
            form.elements[`priority`].value = restaurant.priority;
            form.elements[`notes`].value = restaurant.notes || ``;

            form.scrollIntoView({ behavior: `smooth` });
        }

        function deleteToTry(id) {
            if (!confirm(`確定要刪除這家餐廳嗎？`)) return;

            toTryRestaurants = toTryRestaurants.filter(r => r.id !== id);
            syncToFirebase();
            renderToTryList();
            updateStats();
            showSuccess(`餐廳已刪除`);
        }

        function markAsVisited(id) {
            const restaurant = toTryRestaurants.find(r => r.id === id);
            if (!restaurant) return;

            switchTab(`rating`);
            const form = document.getElementById(`rating-form`);
            form.elements[`name`].value = restaurant.name;
            form.elements[`cuisine`].value = restaurant.cuisine;
            form.elements[`location`].value = restaurant.location || ``;
            form.elements[`visit-date`].value = new Date().toISOString().split(`T`)[0];

            form.scrollIntoView({ behavior: `smooth` });

            toTryRestaurants = toTryRestaurants.filter(r => r.id !== id);
            syncToFirebase();
            renderToTryList();
            updateStats();
        }

        function addRating(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);

            const rating = {
                id: editingRatingId || Date.now(),
                name: formData.get(`name`),
                cuisine: formData.get(`cuisine`),
                location: formData.get(`location`),
                visitDate: formData.get(`visit-date`),
                overallRating: parseInt(formData.get(`overall-rating`)),
                foodRating: parseInt(formData.get(`food-rating`)),
                serviceRating: parseInt(formData.get(`service-rating`)),
                ambianceRating: parseInt(formData.get(`ambiance-rating`)),
                valueRating: parseInt(formData.get(`value-rating`)),
                pricePaid: formData.get(`price-paid`),
                dishes: formData.get(`dishes`),
                highlights: formData.get(`highlights`),
                improvements: formData.get(`improvements`),
                wouldReturn: formData.get(`would-return`),
                review: formData.get(`review`),
                dateAdded: editingRatingId ? ratedRestaurants.find(r => r.id === editingRatingId).dateAdded : new Date().toISOString()
            };

            if (editingRatingId) {
                const index = ratedRestaurants.findIndex(r => r.id === editingRatingId);
                ratedRestaurants[index] = rating;
                showSuccess(`評分已更新！`);
                editingRatingId = null;
            } else {
                ratedRestaurants.push(rating);
                showSuccess(`已新增餐廳評分！`);
            }

            syncToFirebase();
            form.reset();
            document.querySelectorAll(`.star-rating i`).forEach(star => {
                star.classList.remove(`fas`, `active`);
                star.classList.add(`far`);
            });
            document.querySelectorAll(`input[type="hidden"]`).forEach(input => input.value = `0`);
            renderRatingList();
            updateStats();
        }

        function renderRatingList() {
            const container = document.getElementById(`rating-list`);
            const searchTerm = document.getElementById(`search-rating`).value.toLowerCase();
            const cuisineFilter = document.getElementById(`filter-cuisine-rating`).value;
            const sortOption = document.getElementById(`sort-rating`).value;

            let filtered = ratedRestaurants.filter(r => {
                const matchesSearch = r.name.toLowerCase().includes(searchTerm) || 
                                     (r.location && r.location.toLowerCase().includes(searchTerm));
                const matchesCuisine = !cuisineFilter || r.cuisine === cuisineFilter;
                return matchesSearch && matchesCuisine;
            });

            filtered.sort((a, b) => {
                switch(sortOption) {
                    case `date-desc`: return new Date(b.visitDate || b.dateAdded) - new Date(a.visitDate || a.dateAdded);
                    case `date-asc`: return new Date(a.visitDate || a.dateAdded) - new Date(b.visitDate || b.dateAdded);
                    case `rating-high`: return b.overallRating - a.overallRating;
                    case `rating-low`: return a.overallRating - b.overallRating;
                    case `name-asc`: return a.name.localeCompare(b.name);
                    case `name-desc`: return b.name.localeCompare(a.name);
                    default: return 0;
                }
            });

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-star"></i>
                        <h3>還沒有評分記錄</h3>
                        <p>開始記錄您的用餐體驗吧！</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(r => `
                <div class="restaurant-card">
                    <div class="card-header">
                        <h3>${r.name}</h3>
                    </div>
                    <div class="rating-display">
                        <div class="rating-stars">
                            ${generateStars(r.overallRating)}
                        </div>
                        <span class="rating-value">${r.overallRating}.0 / 5.0</span>
                    </div>
                    <div class="card-badges">
                        <span class="badge badge-cuisine">
                            <i class="fas fa-utensils"></i> ${r.cuisine}
                        </span>
                        ${r.visitDate ? `<span class="badge badge-price"><i class="fas fa-calendar"></i> ${new Date(r.visitDate).toLocaleDateString(`zh-TW`)}</span>` : ``}
                    </div>
                    <div class="card-info">
                        ${r.location ? `<p><i class="fas fa-map-marker-alt"></i> ${r.location}</p>` : ``}
                        ${r.pricePaid ? `<p><i class="fas fa-dollar-sign"></i> 實付：NT$ ${r.pricePaid}</p>` : ``}
                    </div>
                    <div class="rating-breakdown">
                        <div class="rating-item">
                            <span>食物品質</span>
                            <span class="rating-item-stars">${generateStars(r.foodRating)}</span>
                        </div>
                        <div class="rating-item">
                            <span>服務品質</span>
                            <span class="rating-item-stars">${generateStars(r.serviceRating)}</span>
                        </div>
                        <div class="rating-item">
                            <span>環境氛圍</span>
                            <span class="rating-item-stars">${generateStars(r.ambianceRating)}</span>
                        </div>
                        <div class="rating-item">
                            <span>性價比</span>
                            <span class="rating-item-stars">${generateStars(r.valueRating)}</span>
                        </div>
                    </div>
                    ${r.wouldReturn ? `<span class="return-badge ${r.wouldReturn}">
                        ${r.wouldReturn === `definitely` ? `✓ 絕對會再訪` : r.wouldReturn === `maybe` ? `? 可能會再訪` : r.wouldReturn === `probably-not` ? `✗ 可能不會` : `✗✗ 絕不再訪`}
                    </span>` : ``}
                    ${r.review ? `<div class="card-info" style="margin-top: 15px;"><p><i class="fas fa-comment"></i> ${r.review.substring(0, 120)}${r.review.length > 120 ? `...` : ``}</p></div>` : ``}
                    <div class="card-actions">
                        <button class="btn btn-primary" onclick="viewFullReview(${r.id})">
                            <i class="fas fa-eye"></i> 查看完整評價
                        </button>
                        <button class="btn btn-secondary" onclick="editRating(${r.id})">
                            <i class="fas fa-edit"></i> 編輯
                        </button>
                        <button class="btn btn-danger" onclick="deleteRating(${r.id})">
                            <i class="fas fa-trash"></i> 刪除
                        </button>
                    </div>
                </div>
            `).join(``);
        }

        function generateStars(rating) {
            let stars = ``;
            for (let i = 1; i <= 5; i++) {
                stars += i <= rating ? `<i class="fas fa-star"></i>` : `<i class="far fa-star"></i>`;
            }
            return stars;
        }

        function viewFullReview(id) {
            const rating = ratedRestaurants.find(r => r.id === id);
            if (!rating) return;

            const modalBody = document.getElementById(`modal-body`);
            modalBody.innerHTML = `
                <h2 style="color: var(--coral); margin-bottom: 20px;">${rating.name}</h2>
                <div class="rating-display" style="margin-bottom: 20px;">
                    <div class="rating-stars">${generateStars(rating.overallRating)}</div>
                    <span class="rating-value">${rating.overallRating}.0 / 5.0</span>
                </div>
                <div class="card-badges" style="margin-bottom: 20px;">
                    <span class="badge badge-cuisine"><i class="fas fa-utensils"></i> ${rating.cuisine}</span>
                    ${rating.visitDate ? `<span class="badge badge-price"><i class="fas fa-calendar"></i> ${new Date(rating.visitDate).toLocaleDateString(`zh-TW`)}</span>` : ``}
                    ${rating.pricePaid ? `<span class="badge badge-price"><i class="fas fa-dollar-sign"></i> NT$ ${rating.pricePaid}</span>` : ``}
                </div>
                ${rating.location ? `<p style="margin-bottom: 15px;"><i class="fas fa-map-marker-alt" style="color: var(--coral); margin-right: 8px;"></i> ${rating.location}</p>` : ``}
                <div class="rating-breakdown" style="margin: 20px 0;">
                    <div class="rating-item">
                        <span>食物品質</span>
                        <span class="rating-item-stars">${generateStars(rating.foodRating)}</span>
                    </div>
                    <div class="rating-item">
                        <span>服務品質</span>
                        <span class="rating-item-stars">${generateStars(rating.serviceRating)}</span>
                    </div>
                    <div class="rating-item">
                        <span>環境氛圍</span>
                        <span class="rating-item-stars">${generateStars(rating.ambianceRating)}</span>
                    </div>
                    <div class="rating-item">
                        <span>性價比</span>
                        <span class="rating-item-stars">${generateStars(rating.valueRating)}</span>
                    </div>
                </div>
                ${rating.wouldReturn ? `<div style="margin: 20px 0;"><span class="return-badge ${rating.wouldReturn}">
                    ${rating.wouldReturn === `definitely` ? `✓ 絕對會再訪` : rating.wouldReturn === `maybe` ? `? 可能會再訪` : rating.wouldReturn === `probably-not` ? `✗ 可能不會` : `✗✗ 絕不再訪`}
                </span></div>` : ``}
                ${rating.dishes ? `<div style="margin: 20px 0;"><h3 style="color: var(--coral); margin-bottom: 10px;"><i class="fas fa-list"></i> 點餐內容</h3><p style="white-space: pre-wrap;">${rating.dishes}</p></div>` : ``}
                ${rating.highlights ? `<div style="margin: 20px 0;"><h3 style="color: var(--coral); margin-bottom: 10px;"><i class="fas fa-heart"></i> 亮點特色</h3><p style="white-space: pre-wrap;">${rating.highlights}</p></div>` : ``}
                ${rating.improvements ? `<div style="margin: 20px 0;"><h3 style="color: var(--coral); margin-bottom: 10px;"><i class="fas fa-tools"></i> 改進建議</h3><p style="white-space: pre-wrap;">${rating.improvements}</p></div>` : ``}
                ${rating.review ? `<div style="margin: 20px 0;"><h3 style="color: var(--coral); margin-bottom: 10px;"><i class="fas fa-comment"></i> 整體評價</h3><p style="white-space: pre-wrap;">${rating.review}</p></div>` : ``}
            `;

            document.getElementById(`review-modal`).classList.add(`active`);
        }

        function closeModal() {
            document.getElementById(`review-modal`).classList.remove(`active`);
        }

        function editRating(id) {
            const rating = ratedRestaurants.find(r => r.id === id);
            if (!rating) return;

            editingRatingId = id;
            const form = document.getElementById(`rating-form`);
            form.elements[`name`].value = rating.name;
            form.elements[`cuisine`].value = rating.cuisine;
            form.elements[`location`].value = rating.location || ``;
            form.elements[`visit-date`].value = rating.visitDate || ``;
            form.elements[`price-paid`].value = rating.pricePaid || ``;
            form.elements[`would-return`].value = rating.wouldReturn;
            form.elements[`dishes`].value = rating.dishes || ``;
            form.elements[`highlights`].value = rating.highlights || ``;
            form.elements[`improvements`].value = rating.improvements || ``;
            form.elements[`review`].value = rating.review || ``;

            [`overall`, `food`, `service`, `ambiance`, `value`].forEach(type => {
                const value = rating[`${type}Rating`];
                const input = form.querySelector(`input[name="${type}-rating"]`);
                const stars = form.querySelector(`.star-rating[data-rating="${type}"] i`);
                input.value = value;
                updateStars(form.querySelectorAll(`.star-rating[data-rating="${type}"] i`), value);
            });

            form.scrollIntoView({ behavior: `smooth` });
        }

        function deleteRating(id) {
            if (!confirm(`確定要刪除這筆評分嗎？`)) return;

            ratedRestaurants = ratedRestaurants.filter(r => r.id !== id);
            syncToFirebase();
            renderRatingList();
            updateStats();
            showSuccess(`評分已刪除`);
        }

        function switchTab(tabName) {
            document.querySelectorAll(`.tab`).forEach(tab => tab.classList.remove(`active`));
            document.querySelectorAll(`.tab-content`).forEach(content => content.classList.remove(`active`));

            if (tabName === `to-try`) {
                document.querySelector(`.tab:first-child`).classList.add(`active`);
                document.getElementById(`to-try-tab`).classList.add(`active`);
            } else {
                document.querySelector(`.tab:last-child`).classList.add(`active`);
                document.getElementById(`rating-tab`).classList.add(`active`);
            }
        }

        function filterToTry() {
            renderToTryList();
        }

        function filterRatings() {
            renderRatingList();
        }

        function updateStats() {
            document.getElementById(`stat-to-try`).textContent = toTryRestaurants.length;
            document.getElementById(`stat-rated`).textContent = ratedRestaurants.length;

            if (ratedRestaurants.length > 0) {
                const avgRating = ratedRestaurants.reduce((sum, r) => sum + r.overallRating, 0) / ratedRestaurants.length;
                document.getElementById(`stat-avg-rating`).textContent = avgRating.toFixed(1);

                const cuisineCounts = {};
                [...toTryRestaurants, ...ratedRestaurants].forEach(r => {
                    cuisineCounts[r.cuisine] = (cuisineCounts[r.cuisine] || 0) + 1;
                });
                const topCuisine = Object.keys(cuisineCounts).reduce((a, b) => cuisineCounts[a] > cuisineCounts[b] ? a : b, `-`);
                document.getElementById(`stat-top-cuisine`).textContent = topCuisine;
            } else {
                document.getElementById(`stat-avg-rating`).textContent = `0.0`;
                document.getElementById(`stat-top-cuisine`).textContent = `-`;
            }
        }

        function showSuccess(message) {
            const successMsg = document.getElementById(`success-message`);
            document.getElementById(`success-text`).textContent = message;
            successMsg.classList.add(`show`);
            setTimeout(() => {
                successMsg.classList.remove(`show`);
            }, 3000);
        }

        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute(`data-theme`);
            const newTheme = currentTheme === `dark` ? `light` : `dark`;
            html.setAttribute(`data-theme`, newTheme);
            localStorage.setItem(`theme`, newTheme);

            const themeToggle = document.querySelector(`.theme-toggle span`);
            themeToggle.textContent = newTheme === `dark` ? `淺色模式` : `深色模式`;
            document.querySelector(`.theme-toggle i`).className = newTheme === `dark` ? `fas fa-sun` : `fas fa-moon`;
        }

        function exportData() {
            const data = {
                toTryRestaurants,
                ratedRestaurants,
                exportDate: new Date().toISOString()
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: `application/json` });
            const url = URL.createObjectURL(blob);
            const a = document.createElement(`a`);
            a.href = url;
            a.download = `restaurant-manager-backup-${new Date().toISOString().split(`T`)[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            showSuccess(`資料已匯出！`);
        }

        function shareAccess() {
            alert(`資料匯出功能可以將您的餐廳清單儲存為 JSON 檔案，方便分享和備份！`);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.toTryRestaurants && data.ratedRestaurants) {
                        if (confirm(`確定要匯入資料嗎？這將覆蓋現有資料。`)) {
                            toTryRestaurants = data.toTryRestaurants;
                            ratedRestaurants = data.ratedRestaurants;
                            syncToFirebase();
                            renderToTryList();
                            renderRatingList();
                            updateStats();
                            showSuccess(`資料匯入成功！`);
                        }
                    } else {
                        alert(`無效的資料格式`);
                    }
                } catch (error) {
                    alert(`資料解析失敗`);
                }
            };
            reader.readAsText(file);
            event.target.value = ``;
        }

        document.addEventListener(`DOMContentLoaded`, () => {
            const savedTheme = localStorage.getItem(`theme`) || `light`;
            document.documentElement.setAttribute(`data-theme`, savedTheme);
            if (savedTheme === `dark`) {
                document.querySelector(`.theme-toggle span`).textContent = `淺色模式`;
                document.querySelector(`.theme-toggle i`).className = `fas fa-sun`;
            }

            initializeStarRatings();
            loadFromFirebase();
        });

        document.getElementById(`review-modal`).addEventListener(`click`, (e) => {
            if (e.target.id === `review-modal`) {
                closeModal();
            }
        });
    </script>
    <script src="https://cdn.kuse.ai/sdk.prd.js"></script>
</body>
</html>
